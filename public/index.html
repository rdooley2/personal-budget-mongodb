<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Budget</title>
    <!-- This is an SEO Change -->
    <!-- Added to meta description -->
    <meta name="description" content="Manage your budget with our free app. Track spending, receive alerts, and achieve your own financial goals.">
    <!-- This is an SEO Change -->
    <!-- Added more/optimized meta keywords -->
    <meta name="keywords" content="personal budget app, free finance tools, budget management, financial planning, expense tracking, money management, budget alerts, financial security">
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="main.css">
</head>
<body>

<a href="#main" class="skip">Skip to content</a>
    <!-- This is a Semantic HTML Change -->
    <!-- Wrapped nav and hero section in a header -->
    <header role="banner">
        <!-- This is an A11y Change -->
        <!-- Added ARIA role -->
        <nav role="navigation">
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="login.html">Login</a></li>
                <li><a href="https://google.com">Google</a></li>
            </ul>
        </nav>
        <!-- This is a Semantic HTML Change -->
        <!-- Changed div to section and modified CSS to match-->
        <section class="hero">
            <h1>Personal Budget</h1>
            <h2>A personal-budget management app</h2>
        </section>
    </header>
    <!-- This is an A11y Change -->
    <!-- Added ARIA role -->
    <main role="main" class="center" id="main">
        <!-- This is a Semantic HTML Change -->
        <!-- Changed div to article -->
        <article class="page-area">
            <!-- This is an A11y Change -->
            <!-- Added ARIA Landmark for each of the eight articles -->
            <article aria-describedby="first-article header">
                <h1 id="first-article header">Stay on track</h1>
                <p>
                    Do you know where you are spending your money? If you really stop to track it down,
                    you would get surprised! Proper budget management depends on real data... and this
                    app will help you with that!
                </p>
            </article>
    
            <article aria-describedby="second-article-header">
                <h1 id="second-article-header">Alerts</h1>
                <p>
                    What if your clothing budget ended? You will get an alert. The goal is to never go over the budget.
                </p>
            </article>
    
            <article aria-describedby="third-article-header">
                <h1 id="third-article-header">Results</h1>
                <p>
                    People who stick to a financial plan, budgeting every expense, get out of debt faster!
                    Also, they to live happier lives... since they expend without guilt or fear... 
                    because they know it is all good and accounted for.
                </p>
            </article>
    
            <article aria-describedby="fourth-article-header">
                <h1 id="fourth-article-header">Free</h1>
                <p>
                    This app is free!!! And you are the only one holding your data!
                </p>
            </article>
    
            <article aria-describedby="fifth-article-header">
                <h1 id="fifth-article-header">Stay on track</h1>
                <p>
                    Do you know where you are spending your money? If you really stop to track it down,
                    you would get surprised! Proper budget management depends on real data... and this
                    app will help you with that!
                </p>
            </article>
    
            <article aria-describedby="sixth-article-header">
                <h1 id="sixth-article-header">Alerts</h1>
                <p>
                    What if your clothing budget ended? You will get an alert. The goal is to never go over the budget.
                </p>
            </article>
    
            <article aria-describedby="seventh-article-header">
                <h1 id="seventh-article-header">Results</h1>
                <p>
                    People who stick to a financial plan, budgeting every expense, get out of debt faster!
                    Also, they to live happier lives... since they expend without guilt or fear... 
                    because they know it is all good and accounted for.
                </p>
            </article>
    
            <article aria-describedby="eighth-article-header">
                <h1 id="eighth-article-header">Chart</h1>
                <p>
                    <!-- This is an SEO Change -->
                    <!-- Added ARIA label to the canvas for a more descriptive label-->
                    <canvas id="myChart" width="400" height="400" aria-label="Budget distribution chart"></canvas>
                </p>
            </article>

            <article aria-describedby="ninth-article-header">
                <h1 id="ninth-article-header">D3 Chart</h1>
                <p>
                    <!-- This is an SEO Change -->
                    <!-- Added ARIA label to the canvas for a more descriptive label-->
                    <svg id="myChart2" width="960" height="450" aria-label="Budget distribution chart"></svg>
                </p>
            </article>

        </article>

    </main>
    <!-- This is an A11y Change -->
    <!-- Added ARIA role -->
    <footer role="contentinfo" class="bottom">
        <!-- This is a Semantic HTML Change -->
        <!-- Changed div to section -->
        <section class="center">
            All rights reserved &copy; Fabio Nolasco
        </section>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.20.0/axios.min.js" integrity="sha512-quHCp3WbBNkwLfYUMd+KwBAgpVukJu5MncuQaWXgCrfgcxCJAq/fo+oqrRKOj+UKEmyMCG3tb8RB63W+EmrOBg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js" integrity="sha512-s+xg36jbIujB2S2VKfpGmlC3T5V2TF3lY48DX7u2r9XzGzgPsa6wTpOQA7J9iffvdeBN0q9tKzRxVxw1JviZPg==" crossorigin="anonymous"></script>

    <script src="https://d3js.org/d3.v5.min.js"></script>

    <script>
        fetch('http://localhost:3000/getChartData')
            .then(response => response.json())
            .then(data => {
                const labels = data.map(item => item.title); 
                const values = data.map(item => item.value); 
                const colors = data.map(item => item.color); 


                const ctx = document.getElementById('myChart').getContext('2d');
                new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: values,
                            backgroundColor: colors, 
                            borderColor: colors, 
                            borderWidth: 1,
                        }],
                    },
                    options: {
                        responsive: true,
                    },
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    </script>
    <script>
        fetch('http://localhost:3000/getChartData')
            .then(response => response.json())
            .then(data => {
                const chartData = data.map(item => ({
                    label: item.title, 
                    value: item.value,
                    color: item.color 
                }));
    
       
                const width = 960,
                      height = 450,
                      radius = Math.min(width, height) / 2;
    
       
                const svg = d3.select("#myChart2")
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .append("g")
                    .attr("transform", `translate(${width / 2}, ${height / 2})`);
    
           
                const pie = d3.pie()
                    .value(d => d.value)
                    .sort(null);
    
        
                const arc = d3.arc()
                    .outerRadius(radius * 0.8)
                    .innerRadius(radius * 0.4); 
    

                const outerArc = d3.arc()
                    .innerRadius(radius * 0.9)
                    .outerRadius(radius * 0.9);
    

                const color = d3.scaleOrdinal()
                    .domain(chartData.map(d => d.label))
                    .range(chartData.map(d => d.color));
    
      
                const slices = svg.selectAll("path.slice")
                    .data(pie(chartData))
                    .enter()
                    .append("path")
                    .attr("class", "slice")
                    .attr("d", arc)
                    .style("fill", d => color(d.data.label));
    
         
                const text = svg.selectAll("text")
                    .data(pie(chartData))
                    .enter()
                    .append("text")
                    .attr("dy", ".35em")
                    .text(d => d.data.label)
                    .attr("transform", function(d) {
                        const pos = outerArc.centroid(d);
                        pos[0] = radius * (midAngle(d) < Math.PI ? 1.1 : -1.1); 
                        return `translate(${pos})`;
                    })
                    .style("text-anchor", d => midAngle(d) < Math.PI ? "start" : "end");
    

                svg.selectAll("polyline")
                    .data(pie(chartData))
                    .enter()
                    .append("polyline")
                    .attr("points", function(d) {
                        const pos = outerArc.centroid(d);
                        pos[0] = radius * 0.95 * (midAngle(d) < Math.PI ? 1 : -1);
                        return [arc.centroid(d), outerArc.centroid(d), pos];
                    })
                    .style("stroke", "black")
                    .style("fill", "none")
                    .style("stroke-width", 1.5);
    

                function midAngle(d) {
                    return d.startAngle + (d.endAngle - d.startAngle) / 2;
                }
            })
            .catch(error => console.error('Error fetching data:', error));
    </script>

</body>
</html>